language: node_js
node_js:
    - "lts/*"
cache:
    directories:
        - ./node_modules
if: branch = main
jobs:
    include:
        script:
            - echo 'Installing Deps!'
            - npm ci
            - echo 'Running Build'
            - npm run build
            - echo 'Running Tests'
            - npm test
            - echo 'Installing firebase tools'
            - npm install firebase-tools -g
            - echo 'Deploying!'
            - firebase deploy
    after_success:
        - firebase deploy --token "$FIREBASE_TOKEN"
